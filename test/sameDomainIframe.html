<html>
<head>
<script src="../RESTChannel.js"></script>
<script>
// Google BSD license http://code.google.com/google_bsd_license.html
// Copyright 2011 Google Inc. johnjbarton@google.com


/*globals RESTChannel window console */

window.addEventListener('load', function() {

  console.log(window.location.toString() + ' load ');

  var connection = new RESTChannel.Connection();

  function onAttach() {
    console.log(window.location + ' attach');

    connection.register('hello', {
        put: function (obj) {
          return {message:'hey'};
        }
      }
    );

    connection.putObject( 
      'hello', 
      {message:'I am your child'},
      function(reply) {
        console.log("Child hears: "+reply.message, reply);
      },
      function(err) {
        console.error("Child recvd err", err);
      }
    );
  }

  console.log(window.location + ' talking ');

  RESTChannel.talk(window.parent, connection, onAttach);
});




</script>
</head>
<body>
</body>
</html>